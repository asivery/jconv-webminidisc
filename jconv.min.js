var unknown=63,unknown2=12539,tables={SJIS:require("./tables/SJIS"),JIS:require("./tables/JIS"),JISEXT:require("./tables/JISEXT"),SJISInverted:require("./tables/SJISInverted"),JISInverted:require("./tables/JISInverted"),JISEXTInverted:require("./tables/JISEXTInverted")},encodings={},Encoding=function(c){this.name=c.name;this.unknown=c.unknown;this.convert=c.convert},jconv=module.exports=function(c,k,f){return jconv.convert(c,k,f)};jconv.defineEncoding=function(c){encodings[c.name]=new Encoding(c)};
jconv.convert=function(c,k,f){if(!k)throw Error("Encoding not recognized.");f=getName(f);k=getName(k);if(f===k)return c;c=ensureBuffer(c);var g=f+"to"+k;if(encodings[g])return encodings[g].convert(c);c=encodings[f+"toUTF8"].convert(c);return encodings["UTF8to"+k].convert(c)};
function getName(c){if(!c)return"UTF8";switch(c.toUpperCase()){case "CP932":case "SJIS":case "SHIFTJIS":case "SHIFT_JIS":case "SHIFT_JIS-MS":return"SJIS";case "EUCJP":case "EUC-JP":case "EUC-JP-MS":return"EUCJP";case "JIS":case "ISO2022JP":case "ISO-2022-JP":case "ISO-2022-JP-1":case "ISO-2022-JP-MS":return"JIS";case "UTF8":case "UTF-8":return"UTF8";default:throw Error("Encoding not recognized.");}}
function ensureBuffer(c){c=c||new Buffer(0);return c instanceof Buffer?c:new Buffer(c.toString(),"utf8")}function toUtf8Buffer(c,k,f){128>c?k[f++]=c:(2048>c?k[f++]=192|c>>>6:(65536>c?k[f++]=224|c>>>12:(2097152>c?k[f++]=240|c>>>18:(67108864>c?k[f++]=248|c>>>24:(k[f++]=252|c/1073741824,k[f++]=128|c>>>24&63),k[f++]=128|c>>>18&63),k[f++]=128|c>>>12&63),k[f++]=128|c>>>6&63),k[f++]=128|c&63);return f}function toUnicodeBuffer(c,k,f){k[f++]=c&255;k[f++]=c>>8;return f}
jconv.defineEncoding({name:"UTF8toSJIS",unknown:tables.SJISInverted[unknown2],convert:function(c){for(var k=tables.SJISInverted,f=c.length,g=new Buffer(2*f),d=0,a,b=0;b<f;){a=c[b++];switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:a=(a&31)<<6|c[b++]&63;break;case 14:a=(a&15)<<12|(c[b++]&63)<<6|c[b++]&63;break;default:a=(a&7)<<18|(c[b++]&63)<<12|(c[b++]&63)<<6|c[b++]&63}128>a?g[d++]=a:65377<=a&&65439>=a?g[d++]=a-65216:(a=k[a]||this.unknown,g[d++]=a>>8,g[d++]=
a&255)}return g.slice(0,d)}});
jconv.defineEncoding({name:"UTF8toJIS",unknown:tables.JISInverted[unknown2],convert:function(c){for(var k=tables.JISInverted,f=tables.JISEXTInverted,g=c.length,d=new Buffer(3*g+3),a=0,b,e,h=0;h<g;){b=c[h++];switch(b>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:b=(b&31)<<6|c[h++]&63;break;case 14:b=(b&15)<<12|(c[h++]&63)<<6|c[h++]&63;break;default:b=(b&7)<<18|(c[h++]&63)<<12|(c[h++]&63)<<6|c[h++]&63}if(128>b)0!==e&&(e=0,d[a++]=27,d[a++]=40,d[a++]=66),d[a++]=b;else if(65377<=
b&&65439>=b)1!==e&&(e=1,d[a++]=27,d[a++]=40,d[a++]=73),d[a++]=b-65344;else{var l=k[b];l?(2!==e&&(e=2,d[a++]=27,d[a++]=36,d[a++]=66),d[a++]=l>>8,d[a++]=l&255):(b=f[b])?(3!==e&&(e=3,d[a++]=27,d[a++]=36,d[a++]=40,d[a++]=68),d[a++]=b>>8,d[a++]=b&255):(2!==e&&(e=2,d[a++]=27,d[a++]=36,d[a++]=66),d[a++]=this.unknown>>8,d[a++]=this.unknown&255)}}0!==e&&(d[a++]=27,d[a++]=40,d[a++]=66);return d.slice(0,a)}});
jconv.defineEncoding({name:"UTF8toEUCJP",unknown:tables.JISInverted[unknown2],convert:function(c){for(var k=tables.JISInverted,f=tables.JISEXTInverted,g=c.length,d=new Buffer(2*g),a=0,b,e=0;e<g;){b=c[e++];switch(b>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:b=(b&31)<<6|c[e++]&63;break;case 14:b=(b&15)<<12|(c[e++]&63)<<6|c[e++]&63;break;default:b=(b&7)<<18|(c[e++]&63)<<12|(c[e++]&63)<<6|c[e++]&63}if(128>b)d[a++]=b;else if(65377<=b&&65439>=b)d[a++]=142,d[a++]=b-
65472;else{var h=k[b];h?(d[a++]=(h>>8)-128,d[a++]=(h&255)-128):(b=f[b])?(d[a++]=143,d[a++]=(b>>8)-128,d[a++]=(b&255)-128):(d[a++]=(this.unknown>>8)-128,d[a++]=(this.unknown&255)-128)}}return d.slice(0,a)}});jconv.defineEncoding({name:"SJIStoUTF8",convert:function(c){for(var k=tables.SJIS,f=toUtf8Buffer,g=c.length,d=new Buffer(2*g),a=0,b,e=0;e<g;)b=c[e++],128>b||(160<=b&&223>=b?b+=65216:(b=(b<<8)+c[e++],b=k[b]||unknown2)),a=f(b,d,a);return d.slice(0,a)}});
jconv.defineEncoding({name:"SJIStoJIS",convert:function(c){for(var k=tables.SJIS,f=tables.JISInverted,g=c.length,d=new Buffer(3*g+3),a=0,b,e=0;e<g;){var h=c[e++];if(128>h)0!==b&&(b=0,d[a++]=27,d[a++]=40,d[a++]=66),d[a++]=h;else if(161<=h&&223>=h)1!==b&&(b=1,d[a++]=27,d[a++]=40,d[a++]=73),d[a++]=h-128;else if(238>=h){2!==b&&(b=2,d[a++]=27,d[a++]=36,d[a++]=66);var l=c[e++],h=h<<1;159>l?(h=319>h?h-225:h-97,l=126<l?l-32:l-31):(h=319>h?h-224:h-96,l-=126);d[a++]=h;d[a++]=l}else 250<=h&&(2!==b&&(b=2,d[a++]=
27,d[a++]=36,d[a++]=66),h=(h<<8)+c[e++],h=f[k[h]||unknown2],d[a++]=h>>8,d[a++]=h&255)}0!==b&&(d[a++]=27,d[a++]=40,d[a++]=66);return d.slice(0,a)}});
jconv.defineEncoding({name:"SJIStoEUCJP",convert:function(c){for(var k=tables.SJIS,f=tables.JISInverted,g=c.length,d=new Buffer(2*g),a=0,b=0;b<g;){var e=c[b++];if(128>e)d[a++]=e;else if(161<=e&&223>=e)d[a++]=142,d[a++]=e;else if(238>=e){var h=c[b++],e=e<<1;159>h?(e=319>e?e-97:e-225,h=126<h?h+96:h+97):(e=319>e?e-96:e-224,h+=2);d[a++]=e;d[a++]=h}else 250<=e&&(e=(e<<8)+c[b++],e=f[k[e]||unknown2],d[a++]=(e>>8)-128,d[a++]=(e&255)-128)}return d.slice(0,a)}});
jconv.defineEncoding({name:"JIStoUTF8",convert:function(c){for(var k=tables.JIS,f=tables.JISEXT,g=toUtf8Buffer,d=c.length,a=new Buffer(2*d),b=0,e,h=0,l=0;l<d;){var m=c[l++];if(27===m){var m=c[l++],n=c[l++];switch(m){case 40:66===n?h=0:73===n&&(h=1);break;case 36:64===n||66===n?h=2:40===n&&(h=3,l++)}}else{switch(h){case 0:e=m;break;case 1:e=m+65344;break;case 2:e=(m<<8)+c[l++];e=k[e]||unknown2;break;case 3:e=(m<<8)+c[l++],e=f[e]||unknown2}b=g(e,a,b)}}return a.slice(0,b)}});
jconv.defineEncoding({name:"JIStoSJIS",unknown:tables.SJISInverted[unknown2],convert:function(c){for(var k=c.length,f=new Buffer(2*k),g=0,d=0,a=0;a<k;){var b=c[a++];if(27===b){var e=c[a++],b=c[a++];switch(e){case 40:66===b?d=0:73===b&&(d=1);break;case 36:64===b||66===b?d=2:40===b&&(d=3,a++)}}else switch(d){case 0:f[g++]=b;break;case 1:f[g++]=b+128;break;case 2:e=c[a++];b&1?(b>>=1,b=47>b?b+113:b-79,e=95<e?e+32:e+31):(b>>=1,b=47>=b?b+112:b-80,e+=126);f[g++]=b;f[g++]=e;break;case 3:f[g++]=this.unknown>>
8,f[g++]=this.unknown&255,a++}}return f.slice(0,g)}});jconv.defineEncoding({name:"JIStoEUCJP",convert:function(c){for(var k=c.length,f=new Buffer(2*k),g=0,d=0,a=0;a<k;){var b=c[a++];if(27===b){var b=c[a++],e=c[a++];switch(b){case 40:66===e?d=0:73===e&&(d=1);break;case 36:64===e||66===e?d=2:40===e&&(d=3,a++)}}else switch(d){case 0:f[g++]=b;break;case 1:f[g++]=142;f[g++]=b+128;break;case 2:f[g++]=b+128;f[g++]=c[a++]+128;break;case 3:f[g++]=143,f[g++]=b+128,f[g++]=c[a++]+128}}return f.slice(0,g)}});
jconv.defineEncoding({name:"EUCJPtoUTF8",convert:function(c){for(var k=tables.JIS,f=tables.JISEXT,g=toUtf8Buffer,d=c.length,a=new Buffer(2*d),b=0,e,h=0;h<d;){e=c[h++];if(!(128>e))if(142===e)e=c[h++]+65216;else if(143===e){e=c[h++]-128;var l=c[h++]-128;e=(e<<8)+l;e=f[e]||unknown2}else l=e-128,e=c[h++]-128,e=(l<<8)+e,e=k[e]||unknown2;b=g(e,a,b)}return a.slice(0,b)}});
jconv.defineEncoding({name:"EUCJPtoSJIS",unknown:tables.SJISInverted[unknown2],convert:function(c){for(var k=c.length,f=new Buffer(2*k),g=0,d=0;d<k;){var a=c[d++];if(128>a)f[g++]=a;else if(142===a)f[g++]=c[d++];else if(143===a)f[g++]=this.unknown>>8,f[g++]=this.unknown&255,d+=2;else{var b=c[d++];a&1?(a>>=1,a=111>a?a+49:a+113,b=223<b?b-96:b-97):(a>>=1,a=111>=a?a+48:a+112,b-=2);f[g++]=a;f[g++]=b}}return f.slice(0,g)}});
jconv.defineEncoding({name:"EUCJPtoJIS",convert:function(c){for(var k=c.length,f=new Buffer(3*k+3),g=0,d,a=0;a<k;){var b=c[a++];128>b?(0!==d&&(d=0,f[g++]=27,f[g++]=40,f[g++]=66),f[g++]=b):(142===b?1!==d&&(d=1,f[g++]=27,f[g++]=40,f[g++]=73):143===b?(3!==d&&(d=3,f[g++]=27,f[g++]=36,f[g++]=40,f[g++]=68),f[g++]=c[a++]-128):(2!==d&&(d=2,f[g++]=27,f[g++]=36,f[g++]=66),f[g++]=b-128),f[g++]=c[a++]-128)}0!==d&&(f[g++]=27,f[g++]=40,f[g++]=66);return f.slice(0,g)}});
